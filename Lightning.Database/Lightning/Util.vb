Imports System.Text

Namespace Lightning
    Public Module Util
        Private ReadOnly ToHexDict As New Dictionary(Of Byte, String) From {
            { 000, "00" },{ 001, "01" },{ 002, "02" },{ 003, "03" },
            { 004, "04" },{ 005, "05" },{ 006, "06" },{ 007, "07" },
            { 008, "08" },{ 009, "09" },{ 010, "0A" },{ 011, "0B" },
            { 012, "0C" },{ 013, "0D" },{ 014, "0E" },{ 015, "0F" },
            { 016, "10" },{ 017, "11" },{ 018, "12" },{ 019, "13" },
            { 020, "14" },{ 021, "15" },{ 022, "16" },{ 023, "17" },
            { 024, "18" },{ 025, "19" },{ 026, "1A" },{ 027, "1B" },
            { 028, "1C" },{ 029, "1D" },{ 030, "1E" },{ 031, "1F" },
            { 032, "20" },{ 033, "21" },{ 034, "22" },{ 035, "23" },
            { 036, "24" },{ 037, "25" },{ 038, "26" },{ 039, "27" },
            { 040, "28" },{ 041, "29" },{ 042, "2A" },{ 043, "2B" },
            { 044, "2C" },{ 045, "2D" },{ 046, "2E" },{ 047, "2F" },
            { 048, "30" },{ 049, "31" },{ 050, "32" },{ 051, "33" },
            { 052, "34" },{ 053, "35" },{ 054, "36" },{ 055, "37" },
            { 056, "38" },{ 057, "39" },{ 058, "3A" },{ 059, "3B" },
            { 060, "3C" },{ 061, "3D" },{ 062, "3E" },{ 063, "3F" },
            { 064, "40" },{ 065, "41" },{ 066, "42" },{ 067, "43" },
            { 068, "44" },{ 069, "45" },{ 070, "46" },{ 071, "47" },
            { 072, "48" },{ 073, "49" },{ 074, "4A" },{ 075, "4B" },
            { 076, "4C" },{ 077, "4D" },{ 078, "4E" },{ 079, "4F" },
            { 080, "50" },{ 081, "51" },{ 082, "52" },{ 083, "53" },
            { 084, "54" },{ 085, "55" },{ 086, "56" },{ 087, "57" },
            { 088, "58" },{ 089, "59" },{ 090, "5A" },{ 091, "5B" },
            { 092, "5C" },{ 093, "5D" },{ 094, "5E" },{ 095, "5F" },
            { 096, "60" },{ 097, "61" },{ 098, "62" },{ 099, "63" },
            { 100, "64" },{ 101, "65" },{ 102, "66" },{ 103, "67" },
            { 104, "68" },{ 105, "69" },{ 106, "6A" },{ 107, "6B" },
            { 108, "6C" },{ 109, "6D" },{ 110, "6E" },{ 111, "6F" },
            { 112, "70" },{ 113, "71" },{ 114, "72" },{ 115, "73" },
            { 116, "74" },{ 117, "75" },{ 118, "76" },{ 119, "77" },
            { 120, "78" },{ 121, "79" },{ 122, "7A" },{ 123, "7B" },
            { 124, "7C" },{ 125, "7D" },{ 126, "7E" },{ 127, "7F" },
            { 128, "80" },{ 129, "81" },{ 130, "82" },{ 131, "83" },
            { 132, "84" },{ 133, "85" },{ 134, "86" },{ 135, "87" },
            { 136, "88" },{ 137, "89" },{ 138, "8A" },{ 139, "8B" },
            { 140, "8C" },{ 141, "8D" },{ 142, "8E" },{ 143, "8F" },
            { 144, "90" },{ 145, "91" },{ 146, "92" },{ 147, "93" },
            { 148, "94" },{ 149, "95" },{ 150, "96" },{ 151, "97" },
            { 152, "98" },{ 153, "99" },{ 154, "9A" },{ 155, "9B" },
            { 156, "9C" },{ 157, "9D" },{ 158, "9E" },{ 159, "9F" },
            { 160, "A0" },{ 161, "A1" },{ 162, "A2" },{ 163, "A3" },
            { 164, "A4" },{ 165, "A5" },{ 166, "A6" },{ 167, "A7" },
            { 168, "A8" },{ 169, "A9" },{ 170, "AA" },{ 171, "AB" },
            { 172, "AC" },{ 173, "AD" },{ 174, "AE" },{ 175, "AF" },
            { 176, "B0" },{ 177, "B1" },{ 178, "B2" },{ 179, "B3" },
            { 180, "B4" },{ 181, "B5" },{ 182, "B6" },{ 183, "B7" },
            { 184, "B8" },{ 185, "B9" },{ 186, "BA" },{ 187, "BB" },
            { 188, "BC" },{ 189, "BD" },{ 190, "BE" },{ 191, "BF" },
            { 192, "C0" },{ 193, "C1" },{ 194, "C2" },{ 195, "C3" },
            { 196, "C4" },{ 197, "C5" },{ 198, "C6" },{ 199, "C7" },
            { 200, "C8" },{ 201, "C9" },{ 202, "CA" },{ 203, "CB" },
            { 204, "CC" },{ 205, "CD" },{ 206, "CE" },{ 207, "CF" },
            { 208, "D0" },{ 209, "D1" },{ 210, "D2" },{ 211, "D3" },
            { 212, "D4" },{ 213, "D5" },{ 214, "D6" },{ 215, "D7" },
            { 216, "D8" },{ 217, "D9" },{ 218, "DA" },{ 219, "DB" },
            { 220, "DC" },{ 221, "DD" },{ 222, "DE" },{ 223, "DF" },
            { 224, "E0" },{ 225, "E1" },{ 226, "E2" },{ 227, "E3" },
            { 228, "E4" },{ 229, "E5" },{ 230, "E6" },{ 231, "E7" },
            { 232, "E8" },{ 233, "E9" },{ 234, "EA" },{ 235, "EB" },
            { 236, "EC" },{ 237, "ED" },{ 238, "EE" },{ 239, "EF" },
            { 240, "F0" },{ 241, "F1" },{ 242, "F2" },{ 243, "F3" },
            { 244, "F4" },{ 245, "F5" },{ 246, "F6" },{ 247, "F7" },
            { 248, "F8" },{ 249, "F9" },{ 250, "FA" },{ 251, "FB" },
            { 252, "FC" },{ 253, "FD" },{ 254, "FE" },{ 255, "FF" }}
        
        Private ReadOnly FromHexDict As New Dictionary(Of String, Byte) From {
            { "00", 000 },{ "01", 001 },{ "02", 002 },{ "03", 003 },
            { "04", 004 },{ "05", 005 },{ "06", 006 },{ "07", 007 },
            { "08", 008 },{ "09", 009 },{ "0A", 010 },{ "0B", 011 },
            { "0C", 012 },{ "0D", 013 },{ "0E", 014 },{ "0F", 015 },
            { "10", 016 },{ "11", 017 },{ "12", 018 },{ "13", 019 },
            { "14", 020 },{ "15", 021 },{ "16", 022 },{ "17", 023 },
            { "18", 024 },{ "19", 025 },{ "1A", 026 },{ "1B", 027 },
            { "1C", 028 },{ "1D", 029 },{ "1E", 030 },{ "1F", 031 },
            { "20", 032 },{ "21", 033 },{ "22", 034 },{ "23", 035 },
            { "24", 036 },{ "25", 037 },{ "26", 038 },{ "27", 039 },
            { "28", 040 },{ "29", 041 },{ "2A", 042 },{ "2B", 043 },
            { "2C", 044 },{ "2D", 045 },{ "2E", 046 },{ "2F", 047 },
            { "30", 048 },{ "31", 049 },{ "32", 050 },{ "33", 051 },
            { "34", 052 },{ "35", 053 },{ "36", 054 },{ "37", 055 },
            { "38", 056 },{ "39", 057 },{ "3A", 058 },{ "3B", 059 },
            { "3C", 060 },{ "3D", 061 },{ "3E", 062 },{ "3F", 063 },
            { "40", 064 },{ "41", 065 },{ "42", 066 },{ "43", 067 },
            { "44", 068 },{ "45", 069 },{ "46", 070 },{ "47", 071 },
            { "48", 072 },{ "49", 073 },{ "4A", 074 },{ "4B", 075 },
            { "4C", 076 },{ "4D", 077 },{ "4E", 078 },{ "4F", 079 },
            { "50", 080 },{ "51", 081 },{ "52", 082 },{ "53", 083 },
            { "54", 084 },{ "55", 085 },{ "56", 086 },{ "57", 087 },
            { "58", 088 },{ "59", 089 },{ "5A", 090 },{ "5B", 091 },
            { "5C", 092 },{ "5D", 093 },{ "5E", 094 },{ "5F", 095 },
            { "60", 096 },{ "61", 097 },{ "62", 098 },{ "63", 099 },
            { "64", 100 },{ "65", 101 },{ "66", 102 },{ "67", 103 },
            { "68", 104 },{ "69", 105 },{ "6A", 106 },{ "6B", 107 },
            { "6C", 108 },{ "6D", 109 },{ "6E", 110 },{ "6F", 111 },
            { "70", 112 },{ "71", 113 },{ "72", 114 },{ "73", 115 },
            { "74", 116 },{ "75", 117 },{ "76", 118 },{ "77", 119 },
            { "78", 120 },{ "79", 121 },{ "7A", 122 },{ "7B", 123 },
            { "7C", 124 },{ "7D", 125 },{ "7E", 126 },{ "7F", 127 },
            { "80", 128 },{ "81", 129 },{ "82", 130 },{ "83", 131 },
            { "84", 132 },{ "85", 133 },{ "86", 134 },{ "87", 135 },
            { "88", 136 },{ "89", 137 },{ "8A", 138 },{ "8B", 139 },
            { "8C", 140 },{ "8D", 141 },{ "8E", 142 },{ "8F", 143 },
            { "90", 144 },{ "91", 145 },{ "92", 146 },{ "93", 147 },
            { "94", 148 },{ "95", 149 },{ "96", 150 },{ "97", 151 },
            { "98", 152 },{ "99", 153 },{ "9A", 154 },{ "9B", 155 },
            { "9C", 156 },{ "9D", 157 },{ "9E", 158 },{ "9F", 159 },
            { "A0", 160 },{ "A1", 161 },{ "A2", 162 },{ "A3", 163 },
            { "A4", 164 },{ "A5", 165 },{ "A6", 166 },{ "A7", 167 },
            { "A8", 168 },{ "A9", 169 },{ "AA", 170 },{ "AB", 171 },
            { "AC", 172 },{ "AD", 173 },{ "AE", 174 },{ "AF", 175 },
            { "B0", 176 },{ "B1", 177 },{ "B2", 178 },{ "B3", 179 },
            { "B4", 180 },{ "B5", 181 },{ "B6", 182 },{ "B7", 183 },
            { "B8", 184 },{ "B9", 185 },{ "BA", 186 },{ "BB", 187 },
            { "BC", 188 },{ "BD", 189 },{ "BE", 190 },{ "BF", 191 },
            { "C0", 192 },{ "C1", 193 },{ "C2", 194 },{ "C3", 195 },
            { "C4", 196 },{ "C5", 197 },{ "C6", 198 },{ "C7", 199 },
            { "C8", 200 },{ "C9", 201 },{ "CA", 202 },{ "CB", 203 },
            { "CC", 204 },{ "CD", 205 },{ "CE", 206 },{ "CF", 207 },
            { "D0", 208 },{ "D1", 209 },{ "D2", 210 },{ "D3", 211 },
            { "D4", 212 },{ "D5", 213 },{ "D6", 214 },{ "D7", 215 },
            { "D8", 216 },{ "D9", 217 },{ "DA", 218 },{ "DB", 219 },
            { "DC", 220 },{ "DD", 221 },{ "DE", 222 },{ "DF", 223 },
            { "E0", 224 },{ "E1", 225 },{ "E2", 226 },{ "E3", 227 },
            { "E4", 228 },{ "E5", 229 },{ "E6", 230 },{ "E7", 231 },
            { "E8", 232 },{ "E9", 233 },{ "EA", 234 },{ "EB", 235 },
            { "EC", 236 },{ "ED", 237 },{ "EE", 238 },{ "EF", 239 },
            { "F0", 240 },{ "F1", 241 },{ "F2", 242 },{ "F3", 243 },
            { "F4", 244 },{ "F5", 245 },{ "F6", 246 },{ "F7", 247 },
            { "F8", 248 },{ "F9", 249 },{ "FA", 250 },{ "FB", 251 },
            { "FC", 252 },{ "FD", 253 },{ "FE", 254 },{ "FF", 255 }}
        
        Public Function ToHex(Input As String) As String
            If Input Is Nothing OrElse Input.Length = 0 Then Return String.Empty
            Dim Buffer As Byte() = Encoding.ASCII.GetBytes(Input)
            Dim Builder As New StringBuilder((Buffer.Length*2)-1)
            For Index = 0 To Buffer.Length - 1
                Builder.Append(ToHexDict(Buffer(Index)))
            Next 
            Dim Result As String = Builder.ToString()
            
            Array.Clear(Buffer, 0, Buffer.Length)
            Array.Resize(Buffer, 0)
            Buffer = Nothing
            
            Builder.Clear()
            Builder = Nothing
            
            Return Result
        End Function
        
        Public Function FromHex(Input As String) As String
            If Input Is Nothing OrElse Input.Length < 2 Then Return String.Empty
            Dim LookupValue(1) As Char
            Dim Buffer((Input.Length\2) - 1) As Byte
            For Index = 0 To Input.Length - 1 Step 2
                LookupValue(0) = Input(Index + 0)
                LookupValue(1) = Input(Index + 1)
                Buffer(Index\2) = FromHexDict(LookupValue) 
            Next
            Dim Result As String = Encoding.ASCII.GetString(Buffer)
            
            Array.Clear(Buffer, 0, Buffer.Length)
            Array.Resize(Buffer, 0)
            Buffer = Nothing
            
            Array.Clear(LookupValue, 0, LookupValue.Length)
            Array.Resize(LookupValue, 0)
            LookupValue = Nothing
            
            Return Result
        End Function
    End Module
End Namespace